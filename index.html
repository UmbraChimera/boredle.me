<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Boredle.me</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
      }

      #toolbar {
        background-color: #333;
        color: #fff;
        padding: 0px;
        text-align: center;
      }

      #toolbar h1 {
        margin: 0;
      }

      #toolbar button {
        margin: 5px;
        padding: 20px 20px;
        background-color: #555;
        color: #fff;
        border: none;
        cursor: pointer;
        display: none;
        /* Hide Prev/Next buttons by default */
      }

      #options-container {
        padding: 20px;
      }

      #options-container label {
        display: block;
        margin-bottom: 10px;
      }

      #iframe-container {
        display: none;
        /* Hide iframe container by default */
      }

      #iframe-container iframe {
        width: 100%;
        height: calc(100vh - 15vh);
        /* Adjust the height as needed */
        border: none;
      }
    </style>
  </head>
  <body>
    <div id="options-container">
      <h2>Select Websites:</h2>
      <form id="options-form">
        <label>
          <input type="checkbox" id="select-all" onchange="selectAll()" />
          Select All
        </label>
        <br />
        <label>
          <input type="checkbox" name="website" value="https://guessthe.game" />
          Guess The Game
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://games.oec.world/en/tradle/"
          />
          Tradle
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://globle-game.com/"
          />
          Globle Game
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://worldle.teuteuf.fr/"
          />
          Worldle
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://costcodle.com/"
          />
          Costcodle
        </label>
        <label>
          <input type="checkbox" name="website" value="https://framed.wtf/" />
          Framed
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://timeguessr.com/"
          />
          Timeguessr
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://www.merriam-webster.com/games/quordle/"
          />
          Merriam-Webster Quordle
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://dailydozentrivia.com/"
          />
          Daily Dozen Trivia
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://heardlewordle.io/"
          />
          Heardle Wordle
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://mario-heardle.glitch.me/"
          />
          Mario Heardle
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://zelda-heardle.glitch.me/"
          />
          Zelda Heardle
        </label>
        <label>
          <input type="checkbox" name="website" value="https://travle.earth/" />
          Travle
        </label>
        <label>
          <input type="checkbox" name="website" value="https://moviegrid.io/" />
          Movie Grid
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://spellcheckgame.com/"
          />
          Spellcheck Game
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://boxofficega.me/"
          />
          Box Office Game
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://movietomovie.com/"
          />
          Movie to Movie
        </label>
        <label>
          <input type="checkbox" name="website" value="https://metazooa.com/" />
          Metazooa
        </label>
        <label>
          <input type="checkbox" name="website" value="https://bandle.app/" />
          Bandle
        </label>
        <label>
          <input type="checkbox" name="website" value="https://listed.fun/" />
          Listed
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://www.chronophoto.app/"
          />
          Chronophoto
        </label>
        <label>
          <input
            type="checkbox"
            name="website"
            value="https://playdopple.com/"
          />
          Playdopple
        </label>
        <!-- Add more options here -->
        <label
          >Custom URL:
          <input
            type="text"
            id="custom-url"
            onkeydown="if(event.keyCode === 13) { event.preventDefault(); addCustomURL(); }"
          />
        </label>
        <button type="button" onclick="addCustomURL()">Add Custom URL</button>
        <button type="submit">Launch</button>
      </form>
    </div>
    <header id="toolbar">
      <div style="position: relative; padding-bottom: 4vh">
        <h1 style="position: absolute; left: 50%; transform: translateX(-50%)">
          Boredle.me
        </h1>
        <a
          href="https://ko-fi.com/J3J6VRKCS"
          target="_blank"
          style="position: absolute; right: 0"
        >
          <img
            height="20"
            style="height: 20px"
            src="https://storage.ko-fi.com/cdn/brandasset/kofi_s_tag_dark.png"
            alt="Buy Me a Coffee at ko-fi.com"
          />
        </a>
      </div>
      <button onclick="prevWebsite()">Prev</button>
      <span id="progress"></span>
      <button onclick="nextWebsite()">Next</button>
    </header>
    <main id="iframe-container">
      <!-- This is where the iframe will be loaded -->
    </main>
    <script>
      var currentIndex = 0;
      var selectedWebsites = [];
      // Function to show options container
      function showOptions() {
        document.getElementById("options-container").style.display = "block";
      }
      // Function to handle form submission
      document
        .getElementById("options-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();
          var checkboxes = document.querySelectorAll(
            "input[name='website']:checked"
          );

          // Clear the selectedWebsites array before adding newly selected websites
          selectedWebsites = [];

          checkboxes.forEach(function (checkbox) {
            selectedWebsites.push(checkbox.value);
          });

          if (selectedWebsites.length > 0) {
            document.getElementById("options-container").style.display = "none"; // Hide options container
            document.getElementById("iframe-container").style.display = "block"; // Show iframe container
            document
              .querySelectorAll("#toolbar button")
              .forEach(function (btn) {
                btn.style.display = "inline-block"; // Show Prev/Next buttons
              });
            loadWebsite(selectedWebsites[currentIndex]); // Load the first website
            displayProgress(); // Show progress initially
            updateUrl(); // Update URL with selected websites
          } else {
            alert("Please select at least one website or add a custom URL.");
          }
        });

      // Function to load website in iframe or open in new tab if it fails to load
      function loadWebsite(url) {
        var iframe = document.createElement("iframe");
        iframe.src = url;
        iframe.onload = function () {
          // Check if the website loaded successfully
          if (
            iframe.contentDocument &&
            iframe.contentDocument.body.innerHTML === ""
          ) {
            window.open(url, "_blank"); // Open in new tab if it failed to load
          }
        };
        iframe.onerror = function () {
          window.open(url, "_blank"); // Open in new tab if it failed to load
        };
        document.getElementById("iframe-container").innerHTML = ""; // Clear previous iframe
        document.getElementById("iframe-container").appendChild(iframe);
      }
      // Function to load next website
      function nextWebsite() {
        currentIndex = (currentIndex + 1) % selectedWebsites.length; // Update to use selectedWebsites
        document.querySelector("#iframe-container iframe").src =
          selectedWebsites[currentIndex]; // Update to use selectedWebsites
        displayProgress();
        updateUrl(); // Update URL with current index
      }
      // Function to load previous website
      function prevWebsite() {
        currentIndex =
          (currentIndex - 1 + selectedWebsites.length) %
          selectedWebsites.length; // Update to use selectedWebsites
        document.querySelector("#iframe-container iframe").src =
          selectedWebsites[currentIndex]; // Update to use selectedWebsites
        displayProgress();
        updateUrl(); // Update URL with current index
      }
      // Function to select all checkboxes
      function selectAll() {
        var selectAllCheckbox = document.getElementById("select-all");
        var checkboxes = document.querySelectorAll("input[name='website']");
        checkboxes.forEach(function (checkbox) {
          checkbox.checked = selectAllCheckbox.checked;
        });
      }
      // Function to parse URL parameters
      function getUrlParams() {
        var urlParams = new URLSearchParams(window.location.search);
        return urlParams.get("websites")
          ? urlParams.get("websites").split(",")
          : [];
      }
      // Function to add custom URL
      function addCustomURL() {
        var customURL = document.getElementById("custom-url").value.trim();
        if (customURL !== "") {
          if (!customURL.includes("://")) {
            // Check if protocol is specified
            customURL = "https://" + customURL; // Prepend https:// if protocol is missing
          }
          var checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.name = "website";
          checkbox.value = customURL;

          var label = document.createElement("label");
          label.appendChild(checkbox);
          label.appendChild(document.createTextNode(customURL));

          document
            .getElementById("options-form")
            .insertBefore(
              label,
              document.getElementById("custom-url").parentNode
            );

          checkbox.checked = true; // Auto-select the added custom URL
          document.getElementById("custom-url").value = ""; // Clear the input field
        }
      }
      // Display progress
      function displayProgress() {
        var progressElement = document.getElementById("progress");
        progressElement.textContent =
          currentIndex + 1 + "/" + selectedWebsites.length; // Update to use selectedWebsites
      }
      // Function to update URL with selected websites
      function updateUrl() {
        var queryString = "websites=";
        queryString += selectedWebsites.join(",");
        history.pushState(
          null,
          null,
          window.location.pathname + "?" + queryString
        );
      }
      // Call the showOptions function when the page loads
      window.onload = function () {
        showOptions();
        var urlParams = getUrlParams();
        if (urlParams.length > 0) {
          // Loop through the checkboxes and check those whose values are in the URL parameters
          var checkboxes = document.querySelectorAll("input[name='website']");
          checkboxes.forEach(function (checkbox) {
            if (urlParams.includes(checkbox.value)) {
              checkbox.checked = true;
              if (!selectedWebsites.includes(checkbox.value)) {
                selectedWebsites.push(checkbox.value);
              }
            }
          });
        }
        // Check for custom URLs in URL parameters
        var customURLParams = urlParams.filter(
          (url) => !selectedWebsites.includes(url)
        );
        customURLParams.forEach(function (customURL) {
          if (!selectedWebsites.includes(customURL)) {
            selectedWebsites.push(customURL);
            // Create checkbox for custom URL
            var checkbox = document.createElement("input");
            checkbox.type = "checkbox";
            checkbox.name = "website";
            checkbox.value = customURL;
            checkbox.checked = true;

            var label = document.createElement("label");
            label.appendChild(checkbox);
            label.appendChild(document.createTextNode(customURL));

            document
              .getElementById("options-form")
              .insertBefore(
                label,
                document.getElementById("custom-url").parentNode
              );
          }
        });
      };
    </script>
  </body>
</html>
